const data = [
   {
      "name": "Ibikunle Justina",
      "number": "0338"
   },
   {
      "name": "James Deborah Odunayo",
      "number": "0060"
   },
   {
      "name": "Salihu Yahaya",
      "number": "1220"
   },
   {
      "name": "Ajisola Glory Ayomide",
      "number": "0712"
   },
   {
      "name": "Akon Eminuel",
      "number": "1556"
   },
   {
      "name": "Moshood Hamdalat",
      "number": "1311"
   },
   {
      "name": "Olawale Williams",
      "number": "0145"
   },
   {
      "name": "Abdulkarim Azeezat",
      "number": "0058"
   },
   {
      "name": "Ehinmiro Grace",
      "number": "0861"
   },
   {
      "name": "Olabode Barakat Abidemi",
      "number": "NIL"
   },
   {
      "name": "Nweke Precious",
      "number": "0093"
   },
   {
      "name": "Rotimi Boluwatife Mary",
      "number": "0622"
   },
   {
      "name": "Hinwa Chinedu",
      "number": "NIL"
   },
   {
      "name": "Ayobamidele Oyetunde",
      "number": "0609"
   },
   {
      "name": "Adewale Sikiru",
      "number": "0773"
   },
   {
      "name": "Adeniyi Boluwatife",
      "number": "0233"
   },
   {
      "name": "Oyeyemi Mary",
      "number": "NIL"
   },
   {
      "name": "Azeez kafayat",
      "number": "1383"
   },
   {
      "name": "Adeagbo Ajoke",
      "number": "1162"
   },
   {
      "name": "Adebayo Monsuru",
      "number": "0894"
   },
   {
      "name": "Oni Sheun Micheal",
      "number": "1319"
   },
   {
      "name": "Salami Ridwan Olalekan",
      "number": "NIL"
   },
   {
      "name": "Yakub Salman Laha",
      "number": "0277"
   },
   {
      "name": "Ziya Esther Wodu",
      "number": "0760"
   },
   {
      "name": "Kareem Khalilat",
      "number": "1230"
   },
   {
      "name": "Olaiya Segun D.",
      "number": "0827"
   },
   {
      "name": "Adegbayo Paul",
      "number": "1385"
   },
   {
      "name": "Rabiu Abeeb ",
      "number": "NIL"
   },
   {
      "name": "Babatunde Abosede A.",
      "number": "0029"
   },
   {
      "name": "Isiaka Anifat O.",
      "number": "0872"
   },
   {
      "name": "Samuel Emmanuel U.",
      "number": "NIL"
   },
   {
      "name": "Abdulwahab Aishat O.",
      "number": "0493"
   },
   {
      "name": "Isiaq Lateefat",
      "number": "1466"
   },
   {
      "name": "Babalola Kemi Racheal",
      "number": "1219"
   },
   {
      "name": "Fatai Adeyemi Barakat",
      "number": "0254"
   },
   {
      "name": "Lawal Zainab Omolola",
      "number": "0416"
   },
   {
      "name": "Okunade Ismaila",
      "number": "1430"
   },
   {
      "name": "Tijani Musiliyu Kolawole",
      "number": "1577"
   },
   {
      "name": "Aleshinloye Abolaji Abdulazeez",
      "number": "NIL"
   },
   {
      "name": "Ibrahim Zainab Bisola",
      "number": "1024"
   },
   {
      "name": "Ikerejimunone Hope Omotebi",
      "number": "NIL"
   },
   {
      "name": "Aderibigbe Dorcas Adeola",
      "number": "0906"
   },
   {
      "name": "Oladunjoye Khadijat Adesewa",
      "number": "0580"
   },
   {
      "name": "Folorunsho Victor Akolade",
      "number": "1129"
   },
   {
      "name": "Awal Musbaudeen",
      "number": "1237"
   },
   {
      "name": "Kazeem Shukurah Apeke",
      "number": "0509"
   },
   {
      "name": "Oyeyemi Hakeem Biola",
      "number": "0463"
   },
   {
      "name": "Irewolede Abidun Nafisat",
      "number": "0925"
   },
   {
      "name": "Joshua Toyosi Bidemi ",
      "number": "1623"
   },
   {
      "name": "Abdullahi Aishat",
      "number": "1392"
   },
   {
      "name": "Adegbola Faizat Adenike",
      "number": "0358"
   },
   {
      "name": "Issa Ayisat Koro",
      "number": "1322"
   },
   {
      "name": "Muhammed Yusuf AlHassan",
      "number": "0270"
   },
   {
      "name": "Echeno Francis Baba",
      "number": "1200"
   },
   {
      "name": "Salami Grace Oyeyinka",
      "number": "1267"
   },
   {
      "name": "Abdullahi Balikis",
      "number": "1534"
   },
   {
      "name": "Sakariyah Suliyat Ayinke",
      "number": "NIL"
   },
   {
      "name": "Mohammed Zainab",
      "number": "0219"
   },
   {
      "name": "Idris Zainab",
      "number": "0732"
   },
   {
      "name": "Oladeji Tosin Shola",
      "number": "0325"
   },
   {
      "name": "AbdulMumeen Abubakar",
      "number": "0216"
   },
   {
      "name": "Akande Quadri Opeyemi",
      "number": "0492"
   },
   {
      "name": "Aina Martha Olabanke",
      "number": "0040"
   },
   {
      "name": "Mudathar Anifa",
      "number": "1675"
   },
   {
      "name": "Adeyemi Nafisat Temitope",
      "number": "0928"
   },
   {
      "name": "Awopejo Bukola Christanah",
      "number": "0425"
   },
   {
      "name": "Adebayo Omowumi Comfort",
      "number": "1517"
   },
   {
      "name": "Kolawole Yemisi Phillomina",
      "number": "1033"
   },
   {
      "name": "Shaibu Balikisu",
      "number": "1414"
   },
   {
      "name": "Ashaolu Beatrice Adesewa",
      "number": "0073"
   },
   {
      "name": "Idowu Aishat Ola",
      "number": "1027"
   },
   {
      "name": "Yusuf Abdullahi Alabanji",
      "number": "0731"
   },
   {
      "name": "Adekunle Memunat Afolashade",
      "number": "1153"
   },
   {
      "name": "Kareem Balikis E.",
      "number": "0772"
   },
   {
      "name": "Akingbade Temilade Nafisat",
      "number": "1191"
   },
   {
      "name": "Ilori Christianah Oluwatoyin",
      "number": "1010"
   },
   {
      "name": "Yakubu Taiye",
      "number": "1260"
   },
   {
      "name": "Dauda Khadijat Abike",
      "number": "0768"
   },
   {
      "name": "Jimeto Julianah Abosede",
      "number": "1063"
   },
   {
      "name": "Olaniyi Hubaidat Olatundun",
      "number": "0322"
   },
   {
      "name": "Usman Mohammed Papa",
      "number": "0587"
   },
   {
      "name": "Usman Ismail Kibe",
      "number": "0690"
   },
   {
      "name": "Abidemi Ifedolapo Prestige",
      "number": "1595"
   },
   {
      "name": "Abubakar Saidat Omowumi",
      "number": "1594"
   },
   {
      "name": "Kareem Shukurat Oluwafunke",
      "number": "NIL"
   },
   {
      "name": "Obetta Nathniel",
      "number": "NIL"
   },
   {
      "name": "Aderibigbe Dorcas Adeola",
      "number": "0906"
   },
   {
      "name": "Akinyele Iwamimo",
      "number": "1167"
   },
   {
      "name": "Salaudeen Amidat",
      "number": "NIL"
   },
   {
      "name": "Abiola OluwaBukola Love",
      "number": "0459"
   },
   {
      "name": "Makinde Adekemi Mercy",
      "number": "1041"
   },
   {
      "name": "Lawal Zainab Omolola",
      "number": "0416"
   },
   {
      "name": "AbdulRaheem Barakah",
      "number": "1224"
   },
   {
      "name": "Sikiru Zainab Omolola",
      "number": "0881"
   },
   {
      "name": "Bolarinde Ipileayo Grace",
      "number": "1066"
   },
   {
      "name": "Popoola Faith Adejumoke",
      "number": "0350"
   },
   {
      "name": "Abdullahi Halimat Oluwabukola",
      "number": "0804"
   },
   {
      "name": "Azeez Amidat Motunrayo",
      "number": "NIL"
   },
   {
      "name": "Isijola Oluwashola Abigail",
      "number": "0178"
   },
   {
      "name": "Olanbiwoninu Devina Boluwatife",
      "number": "0619"
   }
]


const style = `<style>
h3,h4{
   text-align: center;
}
#table-container{
   margin: 1rem 0;

}
table{
   width:650px;
}
table, th, td {
   border: 1px solid black;
   border-collapse: collapse;
 }

 th, td {
   padding: 10px;
 }
 
 th {
   text-align: left;
 }</style>`

//selectors
const tableEl = document.getElementById('table')
const buttonEl = document.getElementById('convert-button')
const content = document.querySelector('#table-container')

const renderTableData = () => {
   tableEl.innerHTML += data.map((item, itemIndex) => 
      `<tr>
         <td>${itemIndex + 1}</td>
         <td>${item.name}</td>
         <td>CHT/PHT/20/${item.number=='NIL'? '' : item.number}</td>
      </tr>`
   ).join(' ')
}

const convertToMsDoc = (element , filename = '') => {

   const header = `<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML to Word Document with JavaScript</title>${style}</head><body>`;
 
   const footer = "</body></html>";

   const html = header + element.innerHTML + footer

   const blob = new Blob(['\ufeff', html], {
       type: 'application/msword'
   });
   
   // Specify link url
   const url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);
   
   // Specify file name
   filename = filename?filename+'.docx':'document.docx';
   
   // Create download link element
   const downloadLink = document.createElement("a");

   document.body.appendChild(downloadLink);
   
   if(navigator.msSaveOrOpenBlob ){
       navigator.msSaveOrOpenBlob(blob, filename);
   }else{
       // Create a link to the file
       downloadLink.href = url;
       
       // Setting the file name
       downloadLink.download = filename;
       
       //triggering the function
       downloadLink.click();
   }
   
   document.body.removeChild(downloadLink);

}

//trigger
buttonEl.addEventListener('click' , e => {
   convertToMsDoc(content,'students')
})

renderTableData()